<html><head><title>4945 - Free Goodies</title></head><body><table cellpadding=3 cellspacing=0 border=1 align=center><tr valign=center><td ROWSPAN=2 align=center valign=center><font size=5 color=0000A0><b><img src="icono.gif"></b></font></td><td COLSPAN=5 width=500 align=center><font size=5 color=0000A0><b>4945 - Free Goodies</b></font><br><a href="http://acmicpc-live-archive.uva.es/nuevoportal/region.php?r=nw&year=2010"><b>Europe - Northwestern - 2010/2011</b></a></font></td></tr><tr valign=center><td width=100>&nbsp;</td><td width=100>&nbsp;</td><td width=100 align=center><a href="http://acmicpc-live-archive.uva.es/nuevoportal/mailer.php?problem=4945"><b>Submit</b></a></td><td width=100>&nbsp;</td><td width=100 align=center><a href="http://acmicpc-live-archive.uva.es/nuevoportal/rankprob.php?p=4945"><b>Ranking</b></a></td></tr></table><p>&nbsp;</p><!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
           "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<meta name="GENERATOR" content="TtH 3.89">
 <style type="text/css"> div.p { margin-top: 7pt;}</style>
 <style type="text/css"><!--
 td div.comp { margin-top: -0.6ex; margin-bottom: -1ex;}
 td div.comb { margin-top: -0.6ex; margin-bottom: -.6ex;}
 td div.hrcomp { line-height: 0.9; margin-top: -0.8ex; margin-bottom: -1ex;}
 td div.norm {line-height:normal;}
 span.roman {font-family: serif; font-style: normal; font-weight: normal;} 
 span.overacc2 {position: relative;  left: .8em; top: -1.2ex;}
 span.overacc1 {position: relative;  left: .6em; top: -1.2ex;} --></style>
 

<title>B - Free Goodies</title>

 <h2><a name="tth_sEc1">B</a>&nbsp;&nbsp;Free Goodies</h2>

<div class="p"><!----></div>
Petra and Jan have just received a box full of free goodies, and want
to divide the goodies between them. However, it is not easy to do this
fairly, since they both value different goodies differently.

<div class="p"><!----></div>
To divide the goodies, they have decided upon the following procedure:
they choose goodies one by one, in turn, until all the goodies are
chosen. A coin is tossed to decide who gets to choose the first
goodie.

<div class="p"><!----></div>
Petra and Jan have different strategies in deciding what to
choose. When faced with a choice, Petra always selects the goodie that
is most valuable to her. In case of a tie, she is very considerate and
picks the one that is least valuable to Jan. (Since Petra and Jan are
good friends, they know exactly how much value the other places on
each goodie.)  

<div class="p"><!----></div>
Jan's strategy, however, consists of maximizing his own final
value. He is also very considerate, so if multiple choices lead to the
same optimal result, he prefers Petra to have as much final value as
possible.

<div class="p"><!----></div>
You are given the result of the initial coin toss. After Jan and Petra
have finished dividing all the goodies between themselves, what is the
total value of the goodies each of them ends up with?

<div class="p"><!----></div>

<h3>Input</h3>
On the first line a positive integer: the number of test cases, at
most 100. After that per test case:

<div class="p"><!----></div>

<ul>
<li> One line with an integer n (1 &#8804; n &#8804; 1&nbsp;000): the
number of goodies.
<div class="p"><!----></div>
</li>

<li> One line with a string, either "<tt>Petra</tt>" or "<tt>Jan</tt>": the
	person that chooses first.
<div class="p"><!----></div>
</li>

<li> n lines with two integers p<sub>i</sub> and j<sub>i</sub> (0 &#8804;  p<sub>i</sub>,j<sub>i</sub> &#8804; 1&nbsp;000) each: the values that Petra and Jan assign to the
  i-th goodie, respectively.
<div class="p"><!----></div>
</li>
</ul>

<div class="p"><!----></div>

<h3>Output</h3>
Per test case:

<ul>
<li>One line with two integers: the value Petra gets and the value
Jan gets. Both values must be according to their own valuations.
<div class="p"><!----></div>
</li>
</ul>

<div class="p"><!----></div>

<h3>Sample in- and output</h3>

<table border="1">
<tr><td width="0"><b>Input</b> </td><td width="0"><b>Output</b> </td></tr>
<tr><td width="0" valign="top">
<pre>3
4
Petra
100&nbsp;80
70&nbsp;80
50&nbsp;80
30&nbsp;50
4
Petra
10&nbsp;1
1&nbsp;10
6&nbsp;6
4&nbsp;4
7
Jan
4&nbsp;1
3&nbsp;1
2&nbsp;1
1&nbsp;1
1&nbsp;2
1&nbsp;3
1&nbsp;4
</pre>
</td><td width="0" valign="top">
<pre>170&nbsp;130
14&nbsp;16
9&nbsp;10
</pre>
</td></tr></table>
</html>
<hr><ADDRESS>Northwestern 2010-2011</ADDRESS><p></body></html>
