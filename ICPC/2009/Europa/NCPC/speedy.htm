<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3c.org/TR/1999/REC-html401-19991224/loose.dtd">
<!-- saved from url=(0050)http://uva.onlinejudge.org/external/116/11693.html -->
<HTML><HEAD><TITLE>E - Speedy Escape</TITLE>
<META content="text/html; charset=iso-8859-1" http-equiv=Content-Type><LINK 
rel=stylesheet type=text/css href="speedy_files/problem.css">
<META name=GENERATOR content="MSHTML 8.00.7600.16490"></HEAD>
<BODY>
<H1>Problem E - Speedy Escape</H1>
<H3>Time limit: X seconds</H3><!-- author: Marcus Isaksson --><IMG 
src="speedy_files/p11693.jpg"> 
<P>The Newton brothers are planning to rob a bank in the city of Alviso and want 
to figure out a way to escape the city's only police car. They know that their 
car is faster than the police car so if they could just reach one of the 
highways exiting the city they will be able to speed away from the police. 
<P>The police car has a maximum speed of 160 km/h. Luckily, the brothers know 
where the police car will start (it's parked at the police station). To be on 
the safe side they assume that the police car will start moving as soon as they 
leave the bank and start their car (this is when the alarm goes off). 
<P>The brothers want to find a fixed route that ensures that they are able to 
leave the city no matter what route the police car take and at what speed it 
drives. However, since the brothers are not very confident drivers they don't 
want to drive faster than necessary. Luckily they have recently invested in a 
new hi-tech in-car police escape system that <I>you</I> have constructed. This 
system will tell them what the minimal top speed needed to escape is (and 
probably other useful things like what route to take). 
<P>Let's turn the clock back a bit to the time when you were constructing the 
escape system and focused on finding the minimal required speed. Can you get it 
right? 
<P><I>You may treat all roads as infinitesimally narrow and both cars as point 
objects. If the brothers ever end up at the same point (on any road or 
intersection) at the same time as the police car they will be caught and by 
Murphy's law if there is any possibility of this happening it will happen. The 
two cars start simultaneously and can accelerate/decelerate instantaneously at 
any time to any speed below or equal to its maximum speed. They can also change 
roads at intersections or direction anywhere on a road instantaneously no matter 
what speed they are traveling at. </I>
<H2>Input</H2>
<P>The first line of the input file contains an integer N (N&lt;32) which 
denotes the total number of test cases. The description of each test case is 
given below:<BR><BR>The first line consists of three integers <I>n</I>, <I>m</I> 
and <I>e</I>, where <I>2 &#8804; n &#8804; 100</I> describe the number of intersections, 
<I>1 &#8804; m &#8804; 5000</I> describes the number of roads in the city and <I>1 &#8804; e &#8804; 
n</I> describes the number of highway exits. Then follow <I>m</I> lines, each 
consisting of three integers <I>a,b,l</I> such that <I>1 &#8804; a &lt; b &#8804; n</I> and 
<I>1 &#8804; l &#8804; 100</I> describing a road of length <I>l</I> hundred meters from 
intersection <I>a</I> to intersection <I>b</I>. Then follows a line of <I>e</I> 
integers, each one a number in <I>1, ..., n</I> describing which intersections 
are connected to highway exits. Finally there is a line with two integers 
<I>b</I> and <I>p</I> (<I>1 &#8804; b,p &#8804; n</I> and <I>b &#8800; p</I>) describing the 
intersections where the brothers and the police cars start, respectively. 
<P><I>It will always be possible to travel from any intersection to any other 
intersection. Roads are only connected at intersection points (although they may 
cross using bridges or tunnels at others points). Roads can be used in both 
directions but there cannot be more than one road between two intersections. 
</I>
<H2>Output</H2>
<P>For each test case print the minimal speed in km/h required to escape or the 
word <TT>IMPOSSIBLE</TT> if it is impossible. If the output is not "IMPOSSIBLE", 
any answer with either absolute or relative error smaller than 
<I>10<SUP>-6</SUP></I> is acceptable. 
<DIV class=sample>
<H2>Sample Input</H2><PRE>3
3 2 1
1 2 7
2 3 8
1
3 2
3 2 1
1 2 7
2 3 8
1
2 3
4 4 2
1 4 1
1 3 4
3 4 10
2 3 30
1 2
3 4

</PRE></DIV>
<DIV class=sample>
<H2>Sample Output</H2><PRE>IMPOSSIBLE
74.6666666667
137.142857143

</PRE></DIV>
<DIV class=source>The 2009 ACM Nordic Collegiate Programming Contest 
</DIV></BODY></HTML>
